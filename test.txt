#include <iostream>
#include <string>
using namespace std;

// Định nghĩa cấu trúc cho một giao dịch
struct GiaoDich {
    string moTa;         // Mô tả giao dịch
    double thuNhap;      // Số tiền thu nhập
    double chiTieu;      // Số tiền chi tiêu
    string ngayThucHien; // Ngày thực hiện giao dịch
    GiaoDich* next;      // Con trỏ tới giao dịch tiếp theo
};

// Hàm thêm giao dịch mới
void themGiaoDich(GiaoDich*& danhSach, string moTa, double thuNhap, double chiTieu, string ngayThucHien) {
    GiaoDich* gd = new GiaoDich; // Tạo giao dịch mới
    gd->moTa = moTa;
    gd->thuNhap = thuNhap;
    gd->chiTieu = chiTieu;
    gd->ngayThucHien = ngayThucHien;
    gd->next = danhSach; // Thêm giao dịch mới vào đầu danh sách
    danhSach = gd;
}

// Hàm hiển thị danh sách giao dịch
void hienThiGiaoDich(GiaoDich* danhSach) {
    if (danhSach == nullptr) {
        cout << "Danh sách giao dịch trống!" << endl;
        return;
    }

    GiaoDich* current = danhSach;
    cout << "Danh sách giao dịch: " << endl;
    while (current != nullptr) {
        cout << "Mô tả: " << current->moTa 
             << " | Thu nhập: " << current->thuNhap 
             << " | Chi tiêu: " << current->chiTieu 
             << " | Thời gian: " << current->ngayThucHien << endl;
        current = current->next;
    }
}

// Hàm tính tổng chi tiêu
double tinhTongChiTieu(GiaoDich* danhSach) {
    GiaoDich* current = danhSach;
    double tongChiTieu = 0;
    while (current != nullptr) {
        tongChiTieu += current->chiTieu;
        current = current->next;
    }
    return tongChiTieu;
}

// Hàm tính tổng thu nhập
double tinhTongThuNhap(GiaoDich* danhSach) {
    GiaoDich* current = danhSach;
    double tongThuNhap = 0;
    while (current != nullptr) {
        tongThuNhap += current->thuNhap;
        current = current->next;
    }
    return tongThuNhap;
}

// Hàm nhập thông tin giao dịch từ người dùng
void nhapGiaoDich(GiaoDich*& danhSach) {
    string moTa, ngayThucHien;
    double thuNhap, chiTieu;

    cout << "Nhập mô tả giao dịch: ";
    getline(cin >> ws, moTa);  // ws dùng để xóa các khoảng trắng
    cout << "Nhập số tiền thu nhập: ";
    cin >> thuNhap;
    cout << "Nhập số tiền chi tiêu: ";
    cin >> chiTieu;
    cout << "Nhập thời gian thực hiện: ";
    cin >> ngayThucHien;

    // Thêm giao dịch vào danh sácht
    themGiaoDich(danhSach, moTa, thuNhap, chiTieu, ngayThucHien);
}

// Hàm hiển thị menu
void hienThiMenu() {
    cout << "\n========== QUAN LY CHI TIEU CA NHAN ==========" << endl;
    cout << "1. Nhập giao dịch mới" << endl;
    cout << "2. Hiển thị danh sách giao dịch" << endl;
    cout << "3. Tính tổng chi tiêu" << endl;
    cout << "4. Tính tổng thu nhập" << endl;
    cout << "5. Thoát" << endl;
    cout << "===========================" << endl;
    cout << "Chọn một tùy chọn: ";
}

int main() {
    GiaoDich* danhSach = nullptr; // Khởi tạo danh sách giao dịch rỗng
    int luaChon;
    bool thoat = false;

    while (!thoat) {
        hienThiMenu();
        cin >> luaChon;

        switch (luaChon) {
            case 1:
                nhapGiaoDich(danhSach);
                break;
            case 2:
                hienThiGiaoDich(danhSach);
                break;
            case 3: {
                double tongChiTieu = tinhTongChiTieu(danhSach);
                cout << "Tổng chi tiêu: " << tongChiTieu << endl;
                break;
            }
            case 4: {
                double tongThuNhap = tinhTongThuNhap(danhSach);
                cout << "Tổng thu nhập: " << tongThuNhap << endl;
                break;
            }
            case 5:
                thoat = true;
                cout << "Chương trình kết thúc!" << endl;
                break;
            default:
                cout << "Lựa chọn không hợp lệ. Vui lòng chọn lại." << endl;
        }
    }

    return 0;
}
